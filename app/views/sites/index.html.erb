<% webportal_provisioningbutton_visible = ENV["WEBPORTAL_PROVISIONINGBUTTON_VISIBLE"] %>

	<h1>
		Sites
	<% if !@customer.nil? %>
		of Customer <%= link_to @customer.name, @customer %>
	<% end %>	
	</h1>

<div>
<p id="notice"><%= notice %></p>
<p id="error"><%= error %></p>
<p id="success"><%= success %></p>
</div>


<div>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <% if @customer.nil? %>
      <th>Customer</th>
      <% end %>
      <th>Status</th>
      <th colspan="4"></th>
    </tr>
  </thead>

  <tbody>
    <% @sites.each do |site| %>
      <tr>
        <td><%= link_to site.name, site %></td>
        <% if @customer.nil? %>
        <td>
        	<% if site.customer.nil? %>
        	<%= link_to site.customer, site.customer %>
        	<% else %>
        	<%= link_to site.customer.name, site.customer %>
        	<% end %>       	
        </td>
        <% end %>
        <td>
          <% case site.status
               when /success/
                 statuscolor = "#008800"  # dark green
               when /failure/
                 statuscolor = "red"
               when /progress/
                 statuscolor = "orange"
               else
                 statuscolor = "black"
             end
          %>

          <%= link_to site.status, site_provisionings_path(site), {:style => "color: #{statuscolor}"}%>
        </td>
                        <% if ENV["WEBPORTAL_PROVISIONINGOBJECTS_EDIT_VISIBLE"] == "true" %>
        <td><%= link_to 'Edit', edit_site_path(site), class: "btn btn-default" %></td>
			<% end %>
			<% if ENV["WEBPORTAL_PROVISIONINGBUTTON_VISIBLE"] == "true" %>
        <td><%= link_to 'Provision', provision_site_path(site), method: :patch, class: "btn btn-default", data: { confirm: 'Are you sure?' } %></td>
			<% end %>
			<% if ENV["WEBPORTAL_SYNCHRONIZEBUTTON_VISIBLE"] == "true" %>
        <td><%= link_to 'Synchronize', synchronize_site_path(site), method: :patch, class: "btn btn-default", data: { confirm: 'Are you sure?' } %></td>
			<% end %>
        <td><%= link_to 'Destroy', site, method: :delete, class: "btn btn-default", data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>
</div>


