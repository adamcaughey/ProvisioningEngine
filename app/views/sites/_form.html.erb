<% @alwaysDropDown = true %>


<%= form_for(@site) do |f| %>
  <% if @site.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@site.errors.count, "error") %> prohibited this site from being saved:</h2>

      <ul>
      <% @site.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

<div>
<nav>
	<div class="actions">
		<ul>
			<li><%= f.submit 'Save', class: "action-button" %></li>
			<li>
				<% begin %>
			  	<%= link_to 'Cancel', site_path(@site) %>
			  	<% rescue %>
			  	<%= link_to 'Cancel', sites_path %>
			  	<% end %>
			</li>
		</ul>
	</div>
</nav>
</div>

  <div class="index">
  	 <table> 
  		<thead>
  			<th>Attribute</th>
			<th>Value	</th>
  		</thead>

  		<tbody>
  		<% ro = 'readonly'; rw = 'readwrite' %>
		<% myparams = @myparams %>
		<% myreadonlystyle = "background:#eee none; color:#222"  %>
		<% @site.attributes.each do |attribute| %> 				
			<% if myparams[attribute[0]] == rw %>
				<tr>
			    <td><%= f.label attribute[0] %></td>
			    <td><%= f.text_field attribute[0]  %></td>
			    </tr>
			<% elsif myparams[attribute[0]] == 'none' %>

			<% elsif myparams[attribute[0]] == 'showCustomerDropDown' %>
				<tr>
			    <td><%= f.label attribute[0] %></td>
			    <td>
			    <% begin %>
			    	<% if @alwaysDropDown %>
			    		<%= f.select(:customer_id, Customer.all.map {|customer| [customer.name,customer.id]}, :prompt => "Select a Customer", :selected => @customer.id) %>
			    	<% else %>
		    			<%= f.text_field attribute[0], :value => @customer.id,:readonly => true, :style => myreadonlystyle %>
			    	<% end %>
			    <% rescue %>
			    	<%= f.select(:customer_id, Customer.all.map {|customer| [customer.name,customer.id]}, :prompt => "Select a Customer") %>
			    <% end %>		    
			    </td>
			    </tr>
			<% else # default: show as readonly %>
				<tr>
			    <td><%= f.label attribute[0] %></td>
			    <td><%= f.text_field attribute[0],:readonly => true, :style => myreadonlystyle %></td>
			    </tr>
			<% end # if %>
		<% end # each %>
			<tr>
				<td class="actions">
				  	<%= f.submit 'Save'%>
				</td>
				<td class="actions">
				  	<% begin %>
				  	<%= link_to 'Cancel', site_path(@site) %>
				  	<% rescue %>
				  	<%= link_to 'Cancel', sites_path %>
				  	<% end %>
				</td>
			</tr>
		</tbody>
	</table> 
	  
  </div>
<% end %>
